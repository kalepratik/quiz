<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}dbt Certification Quiz{% endblock %}</title>
    <link rel="icon" type="image/png" href="/static/android-chrome-512x512.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Shared Styles -->
    <style>
        :root {
            --pro-color: #8b5cf6;
        }
        
        .pro-badge {
            background: linear-gradient(135deg, var(--pro-color) 0%, #a855f7 100%);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Dark mode specific styles */
        .dark {
            color-scheme: dark;
        }
        
        .dark {
            background-color: #111827 !important;
            color: #f9fafb !important;
        }
        
        .dark .bg-gray-50 {
            background-color: #1f2937 !important;
        }
        
        .dark .bg-white {
            background-color: #1f2937 !important;
        }
        
        .dark .text-gray-900 {
            color: #f9fafb !important;
        }
        
        .dark .text-gray-600 {
            color: #d1d5db !important;
        }
        
        .dark .text-gray-300 {
            color: #d1d5db !important;
        }
        
        .dark .text-gray-700 {
            color: #e5e7eb !important;
        }
        
        .dark .border-gray-200 {
            border-color: #374151 !important;
        }
        
        .dark .border-gray-600 {
            border-color: #4b5563 !important;
        }
        
        .dark .bg-gray-200 {
            background-color: #374151 !important;
        }
        
        .dark .bg-gray-700 {
            background-color: #374151 !important;
        }
        
        .dark .hover\:bg-gray-300:hover {
            background-color: #4b5563 !important;
        }
        
        .dark .hover\:bg-gray-600:hover {
            background-color: #4b5563 !important;
        }
        
        .dark .hover\:bg-gray-50:hover {
            background-color: #1f2937 !important;
        }
        
        .dark .hover\:bg-gray-800:hover {
            background-color: #1f2937 !important;
        }
        
        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            /* Keep header on single line */
            header .flex.items-center.justify-between {
                flex-direction: row !important;
                gap: 0.5rem;
                text-align: left;
            }
            
            /* Ensure header content doesn't wrap */
            header nav {
                flex-shrink: 0;
            }
            
            header .flex.items-center.space-x-4,
            header .flex.items-center.space-x-2 {
                flex-shrink: 0;
            }
        }
        
        /* Icon alignment fixes */
        .fas, .fa {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }
        
                 /* Ensure navigation stays horizontal */
         nav {
             flex-direction: row !important;
         }
         
         nav a {
             flex-direction: row !important;
             white-space: nowrap;
         }
         

    </style>
    
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Shared Header -->
    <header class="sticky top-0 z-50 glass-effect dark:dark-glass border-b border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 py-3">
            
            <!-- 1. PRO HOMEPAGE, DASHBOARD, HISTORY HEADER -->
            {% if is_pro_user and active_page in ['pro-homepage', 'dashboard', 'history'] %}
            <!-- Desktop Layout -->
            <div class="hidden md:flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-8 w-auto">
                        <span class="text-xl font-bold text-gray-900 dark:text-white">Quiz</span>
                        <span class="pro-badge">PRO</span>
                    </a>
                </div>
                
                <!-- Center Navigation -->
                <nav class="flex items-center space-x-8">
                    <a href="/dashboard" class="{% if active_page == 'dashboard' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-chart-line mr-1"></i>Dashboard
                    </a>
                    <a href="/history" class="{% if active_page == 'history' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-history mr-1"></i>History
                    </a>
                </nav>
                
                <!-- Right Side Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="theme-toggle p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIcon" class="fas fa-moon text-gray-600 dark:text-gray-300" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out -->
                    <button id="signOutBtn" class="px-4 py-2 text-sm font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                </div>
            </div>
            
            <!-- Mobile Layout -->
            <div class="md:hidden flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-6 w-auto">
                        <span class="text-lg font-bold text-gray-900 dark:text-white">Quiz</span>
                        <span class="pro-badge text-xs">PRO</span>
                    </a>
                </div>
                
                <!-- Mobile Navigation -->
                <nav class="flex items-center space-x-2">
                    <a href="/dashboard" class="{% if active_page == 'dashboard' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-chart-line mr-1"></i>Dashboard
                    </a>
                    <a href="/history" class="{% if active_page == 'history' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-history mr-1"></i>History
                    </a>
                </nav>
                
                <!-- Mobile Controls -->
                <div class="flex items-center space-x-1">
                    <!-- Theme Toggle -->
                    <button id="themeToggleMobile" class="theme-toggle p-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIconMobile" class="fas fa-moon text-gray-600 dark:text-gray-300 text-sm" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out -->
                    <button id="signOutBtnMobile" class="px-2 py-1.5 text-xs font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                </div>
            </div>
            
            <!-- 2. SIGNIN, PAYMENT, LEGAL, CONTACT HEADER -->
            {% elif active_page in ['signin', 'payment', 'legal', 'contact'] %}
            <!-- Desktop Layout -->
            <div class="hidden md:flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-8 w-auto">
                        <span class="text-xl font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Center Navigation -->
                <nav class="flex items-center space-x-8">
                    <a href="/" class="{% if active_page == 'home' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                    <a href="/contact" class="{% if active_page == 'contact' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-envelope mr-1"></i>Contact
                    </a>
                    <a href="/legal" class="{% if active_page == 'legal' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-gavel mr-1"></i>Legal
                    </a>
                </nav>
                
                <!-- Right Side Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="theme-toggle p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIcon" class="fas fa-moon text-gray-600 dark:text-gray-300" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Layout -->
            <div class="md:hidden flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-6 w-auto">
                        <span class="text-lg font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Mobile Navigation -->
                <nav class="flex items-center space-x-2">
                    <a href="/" class="{% if active_page == 'home' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                    <a href="/contact" class="{% if active_page == 'contact' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-envelope mr-1"></i>Contact
                    </a>
                    <a href="/legal" class="{% if active_page == 'legal' %}text-purple-600 dark:text-purple-400 font-semibold{% else %}text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400{% endif %} transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-gavel mr-1"></i>Legal
                    </a>
                </nav>
                
                <!-- Mobile Controls -->
                <div class="flex items-center space-x-1">
                    <!-- Theme Toggle -->
                    <button id="themeToggleMobile" class="theme-toggle p-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIconMobile" class="fas fa-moon text-gray-600 dark:text-gray-300 text-sm" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            
            <!-- 3. PRO QUIZ HEADER -->
            {% elif is_pro_user and active_page == 'quiz-pro' %}
            <!-- Desktop Layout -->
            <div class="hidden md:flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-8 w-auto">
                        <span class="text-xl font-bold text-gray-900 dark:text-white">Quiz</span>
                        <span class="pro-badge">PRO</span>
                    </a>
                </div>
                
                <!-- Center Navigation -->
                <nav class="flex items-center space-x-8">
                    <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                </nav>
                
                <!-- Right Side Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="theme-toggle p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIcon" class="fas fa-moon text-gray-600 dark:text-gray-300" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out -->
                    <button id="signOutBtn" class="px-4 py-2 text-sm font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                </div>
            </div>
            
            <!-- Mobile Layout -->
            <div class="md:hidden flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-6 w-auto">
                        <span class="text-lg font-bold text-gray-900 dark:text-white">Quiz</span>
                        <span class="pro-badge text-xs">PRO</span>
                    </a>
                </div>
                
                <!-- Mobile Navigation -->
                <nav class="flex items-center space-x-2">
                    <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                </nav>
                
                <!-- Mobile Controls -->
                <div class="flex items-center space-x-1">
                    <!-- Theme Toggle -->
                    <button id="themeToggleMobile" class="theme-toggle p-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIconMobile" class="fas fa-moon text-gray-600 dark:text-gray-300 text-sm" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out -->
                    <button id="signOutBtnMobile" class="px-2 py-1.5 text-xs font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                </div>
            </div>
            
            <!-- 4. NON-PRO HOMEPAGE HEADER -->
            {% elif not is_pro_user and active_page == 'homepage' %}
            <!-- Desktop Layout -->
            <div class="hidden md:flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-8 w-auto">
                        <span class="text-xl font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Center Navigation (Empty for non-pro homepage) -->
                <nav class="flex items-center space-x-8">
                    <!-- Empty center for non-pro homepage -->
                </nav>
                
                <!-- Right Side Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="theme-toggle p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIcon" class="fas fa-moon text-gray-600 dark:text-gray-300" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Welcome Message and Sign Out -->
                    <div class="flex items-center space-x-3">
                        {% if user_name %}
                        <span class="text-sm text-gray-600 dark:text-gray-400">Welcome, {{ user_name }}</span>
                        {% endif %}
                        <button id="signOutBtn" class="px-4 py-2 text-sm font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                            Sign Out
                        </button>
                        <a href="/quiz" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-semibold">
                            Start Free
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Layout -->
            <div class="md:hidden flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-6 w-auto">
                        <span class="text-lg font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Mobile Navigation (Empty for non-pro homepage) -->
                <nav class="flex items-center space-x-2">
                    <!-- Empty center for non-pro homepage -->
                </nav>
                
                <!-- Mobile Controls -->
                <div class="flex items-center space-x-1">
                    <!-- Theme Toggle -->
                    <button id="themeToggleMobile" class="theme-toggle p-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIconMobile" class="fas fa-moon text-gray-600 dark:text-gray-300 text-sm" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out and Start Free -->
                    <button id="signOutBtnMobile" class="px-2 py-1.5 text-xs font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                    <a href="/quiz" class="px-2 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-xs font-semibold">
                        Start Free
                    </a>
                </div>
            </div>
            
            <!-- 5. REGULAR QUIZ HEADER (for both authenticated and non-authenticated users) -->
            {% elif active_page == 'quiz' %}
            <!-- Desktop Layout -->
            <div class="hidden md:flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-8 w-auto">
                        <span class="text-xl font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Center Navigation -->
                <nav class="flex items-center space-x-8">
                    <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                </nav>
                
                <!-- Right Side Controls -->
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="theme-toggle p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIcon" class="fas fa-moon text-gray-600 dark:text-gray-300" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out/Sign In -->
                    {% if is_authenticated %}
                    <button id="signOutBtn" class="px-4 py-2 text-sm font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                    {% else %}
                    <a href="/signin" class="px-4 py-2 text-sm font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors">
                        Sign In
                    </a>
                    {% endif %}
                </div>
            </div>
            
            <!-- Mobile Layout -->
            <div class="md:hidden flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <a href="/" class="flex items-center space-x-2 hover:opacity-80 transition-opacity" title="Go to Home">
                        <img src="/static/dbt-bit-standalone.png" alt="dbt logo" class="h-6 w-auto">
                        <span class="text-lg font-bold text-gray-900 dark:text-white">Quiz</span>
                    </a>
                </div>
                
                <!-- Mobile Navigation -->
                <nav class="flex items-center space-x-2">
                    <a href="/" class="text-gray-600 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors text-xs flex items-center whitespace-nowrap">
                        <i class="fas fa-home mr-1"></i>Home
                    </a>
                </nav>
                
                <!-- Mobile Controls -->
                <div class="flex items-center space-x-1">
                    <!-- Theme Toggle -->
                    <button id="themeToggleMobile" class="theme-toggle p-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors" aria-label="Toggle dark mode">
                        <i id="themeIconMobile" class="fas fa-moon text-gray-600 dark:text-gray-300 text-sm" aria-hidden="true"></i>
                    </button>
                    
                    <!-- Sign Out/Sign In -->
                    {% if is_authenticated %}
                    <button id="signOutBtnMobile" class="px-2 py-1.5 text-xs font-semibold text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors">
                        Sign Out
                    </button>
                    {% else %}
                    <a href="/signin" class="px-2 py-1.5 text-xs font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors">
                        Sign In
                    </a>
                    {% endif %}
                </div>
            </div>
            
            {% endif %}
        </div>
    </header>

    <!-- Page Content -->
    {% block content %}{% endblock %}

    <!-- Shared JavaScript -->
    <script>
        // Theme toggle functionality
        function initThemeToggle() {
            const themeToggle = document.getElementById('themeToggle');
            const themeToggleMobile = document.getElementById('themeToggleMobile');
            const themeIcon = document.getElementById('themeIcon');
            const themeIconMobile = document.getElementById('themeIconMobile');
            
            // Check for saved theme preference or default to light mode
            const currentTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.classList.toggle('dark', currentTheme === 'dark');
            updateThemeIcon(currentTheme === 'dark');
            
            // Desktop theme toggle
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    const isDark = document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                    updateThemeIcon(isDark);
                });
            }
            
            // Mobile theme toggle
            if (themeToggleMobile) {
                themeToggleMobile.addEventListener('click', function() {
                    const isDark = document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                    updateThemeIcon(isDark);
                });
            }
        }
        
        function updateThemeIcon(isDark) {
            const themeIcon = document.getElementById('themeIcon');
            const themeIconMobile = document.getElementById('themeIconMobile');
            
            if (themeIcon) {
                themeIcon.className = isDark ? 'fas fa-sun text-gray-300' : 'fas fa-moon text-gray-600';
            }
            
            if (themeIconMobile) {
                themeIconMobile.className = isDark ? 'fas fa-sun text-gray-300' : 'fas fa-moon text-gray-600';
            }
        }

        // Sign out functionality
        function initSignOut() {
            const signOutBtn = document.getElementById('signOutBtn');
            const signOutBtnMobile = document.getElementById('signOutBtnMobile');
            
            if (signOutBtn) {
                signOutBtn.addEventListener('click', function() {
                    fetch('/api/signout', { method: 'POST' })
                        .then(() => window.location.href = '/')
                        .catch(error => console.error('Error signing out:', error));
                });
            }
            
            if (signOutBtnMobile) {
                signOutBtnMobile.addEventListener('click', function() {
                    fetch('/api/signout', { method: 'POST' })
                        .then(() => window.location.href = '/')
                        .catch(error => console.error('Error signing out:', error));
                });
            }
        }

        // Initialize header functionality
        document.addEventListener('DOMContentLoaded', function() {
            initThemeToggle();
            initSignOut();
        });
    </script>
    
    {% block extra_scripts %}{% endblock %}
</body>
</html>
